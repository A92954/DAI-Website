<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Cidade amiga</title>

    <!-- Google Font: Source Sans Pro -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback"
    />
    <!-- Font Awesome -->
    <link rel="stylesheet" href="../plugins/fontawesome-free/css/all.min.css" />
    <!-- fullCalendar -->
    <link rel="stylesheet" href="../plugins/fullcalendar/main.css" />
    <!-- Theme style -->
    <link rel="stylesheet" href="../dist/css/adminlte.min.css" />
    <!-- SweetAlert2 -->
    <script src="/plugins/sweetalert2/sweetalert2.min.js"></script>
    <!-- Select2 -->
    <link
      rel="stylesheet"
      href="/Frontend/Backoffice/Adaptado/plugins/select2/css/select2.min.css"
    />
    <link
      rel="stylesheet"
      href="/Frontend/Backoffice/Adaptado/plugins/select2-bootstrap4-theme/select2-bootstrap4.min.css"
    />
  </head>
  <body class="hold-transition sidebar-mini layout-navbar-fixed">
    <!-- layout-fixed -->
    <div class="wrapper">
      <!-- Navbar -->
      <nav
        class="main-header navbar navbar-expand navbar-white navbar-light"
        style="background-color: #132453"
      >
        <!-- Left navbar links -->
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" data-widget="pushmenu" href="#" role="button"
              ><i class="fas fa-bars" style="color: white"></i
            ></a>
          </li>
        </ul>

        <!-- Right navbar links -->
        <ul class="navbar-nav ml-auto">
          <!-- Notifications Dropdown Menu -->
          <li class="nav-item dropdown">
            <a class="nav-link" data-toggle="dropdown" href="#">
              <i class="far fa-bell" style="color: white"></i>
              <span class="badge badge-warning navbar-badge">15</span>
            </a>
            <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
              <span class="dropdown-item dropdown-header"
                >15 Notifications</span
              >
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item">
                <i class="fas fa-envelope mr-2"></i> 4 new messages
                <span class="float-right text-muted text-sm">3 mins</span>
              </a>
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item">
                <i class="fas fa-users mr-2"></i> 8 friend requests
                <span class="float-right text-muted text-sm">12 hours</span>
              </a>
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item">
                <i class="fas fa-file mr-2"></i> 3 new reports
                <span class="float-right text-muted text-sm">2 days</span>
              </a>
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item dropdown-footer"
                >See All Notifications</a
              >
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-widget="fullscreen" href="#" role="button">
              <i class="fas fa-expand-arrows-alt" style="color: white"></i>
            </a>
          </li>
        </ul>
      </nav>
      <!-- /.navbar -->

      <!-- Main Sidebar Container -->
      <aside
        class="main-sidebar sidebar-dark-primary elevation-4"
        style="background-color: #132453"
      >
        <!-- Brand Logo -->
        <a
          href="/Frontend/Backoffice/Adaptado/index.html"
          class="brand-link"
          style="background-color: #132453"
        >
          <img
            src="/Frontend/Backoffice/Adaptado/dist/img/cidadeAmigaLogo.png"
            alt="Cidade amiga Logo"
            class="brand-image img-circle elevation-3"
            style="opacity: 0.8"
          />
          <span class="brand-text font-weight-light">Cidade amiga</span>
        </a>

        <!-- Sidebar -->
        <div class="sidebar">
          <!-- Sidebar Menu -->
          <br />
          <nav class="mt-2">
            <ul
              class="nav nav-pills nav-sidebar flex-column"
              data-widget="treeview"
              role="menu"
              data-accordion="false"
            >
              <!-- esta opção aparece sempre -->
              <div style="background-color: #8f9dc3">
                <li class="nav-item">
                  <a
                    href="/Frontend/Backoffice/Adaptado/index.html"
                    class="nav-link"
                  >
                    <i class="nav-icon fas fa-th"></i>
                    <p style="padding-top: 10px; padding-bottom: 10px">
                      Dashboard
                      <!-- <span class="right badge badge-danger">New</span> -->
                    </p>
                  </a>
                </li>
              </div>
              <br />
              <!-- esta opção só aparece para as instituições -->
              <div style="background-color: #606a85">
                <li class="nav-item">
                  <a href="#" class="nav-link">
                    <i class="nav-icon far fa-calendar-alt"></i>
                    <p style="padding-top: 10px; padding-bottom: 10px">
                      Calendário de atividades
                      <!-- <span class="right badge badge-danger">New</span> -->
                    </p>
                  </a>
                </li>
              </div>
              <br />
              <!-- esta opção aparece sempre -->
              <div style="background-color: #8f9dc3">
                <li class="nav-item">
                  <a
                    href="/Frontend/Backoffice/Adaptado/pages/examples/contacts.html"
                    class="nav-link"
                  >
                    <i class="nav-icon fas fa-edit"></i>
                    <p style="padding-top: 10px; padding-bottom: 10px">
                      Histórico de atividades
                      <!-- <span class="right badge badge-danger">New</span> -->
                    </p>
                  </a>
                </li>
              </div>
              <br />
              <!-- esta opção só aparece para as instituições -->
              <div style="background-color: #8f9dc3">
                <li class="nav-item">
                  <a
                    href="/Frontend/Backoffice/Adaptado/pages/tables/parceiros.html"
                    class="nav-link"
                  >
                    <i class="nav-icon fas fa-handshake"></i>
                    <p style="padding-top: 10px; padding-bottom: 10px">
                      Parceiros
                      <!-- <span class="right badge badge-danger">New</span> -->
                    </p>
                  </a>
                </li>
              </div>
              <br />
              <!-- esta opção só aparece para as instituições -->
              <div style="background-color: #8f9dc3">
                <li class="nav-item">
                  <a
                    href="/Frontend/Backoffice/Adaptado/pages/tables/sugestoes.html"
                    class="nav-link"
                  >
                    <i class="nav-icon fas fa-comment-dots"></i>
                    <p style="padding-top: 10px; padding-bottom: 10px">
                      Sugestões
                      <!-- <span class="right badge badge-danger">New</span> -->
                    </p>
                  </a>
                </li>
              </div>
              <br />
              <!-- esta opção aparece sempre -->
              <div style="background-color: #8f9dc3">
                <li class="nav-item">
                  <a
                    href="/Frontend/Backoffice/Adaptado/pages/examples/profile.html"
                    class="nav-link"
                  >
                    <i class="nav-icon fas fa-check-double"></i>
                    <p style="padding-top: 10px; padding-bottom: 10px">
                      Perfil
                      <!-- <span class="right badge badge-danger">New</span> -->
                    </p>
                  </a>
                </li>
              </div>
              <br />
              <!-- esta opção aparece sempre -->
              <div style="background-color: #8f9dc3">
                <li class="nav-item">
                  <a
                    href="/Frontend/FrontOffice/bizpage-master/bizpage-master/index.html"
                    class="nav-link"
                  >
                    <i class="nav-icon fas fa-house-user"></i>
                    <p style="padding-top: 10px; padding-bottom: 10px">
                      Logout
                      <!-- <span class="right badge badge-danger">New</span> -->
                    </p>
                  </a>
                </li>
              </div>

              <br />
              <br />
            </ul>
          </nav>
          <!-- /.sidebar-menu -->
        </div>
        <!-- /.sidebar -->
      </aside>

      <!-- Content Wrapper. Contains page content -->
      <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header">
          <div class="container-fluid">
            <div class="row mb-2">
              <div class="col-sm-6">
                <h1>Calendário de atividades</h1>
              </div>
            </div>
          </div>
          <!-- /.container-fluid -->
        </section>

        <!-- Main content -->
        <section class="content">
          <div class="container-fluid">
            <div class="row">
              <div class="col-md-3">
                <div class="sticky-top mb-3">
                  <div class="card">
                    <div class="card-header">
                      <h4 class="card-title">Atividades</h4>
                    </div>
                    <div
                      class="card-body"
                      style="
                        width: 100%;
                        height: 15rem;
                        overflow-y: auto;
                        overflow-x: hidden;
                      "
                    >
                      <!-- the events -->
                      <div id="external-events">
                        <!-- <div
                          class="external-event bg-success"
                          data-toggle="modal"
                          data-target="#MaisInfo2"
                        >
                          Lunch
                        </div>
                        <div
                          class="external-event bg-warning"
                          data-toggle="modal"
                          data-target="#MaisInfo2"
                        >
                          Go home
                        </div>
                        <div
                          class="external-event bg-info"
                          data-toggle="modal"
                          data-target="#MaisInfo2"
                        >
                          Do homework
                        </div>
                        <div
                          class="external-event bg-primary"
                          data-toggle="modal"
                          data-target="#MaisInfo2"
                        >
                          Work on UI design
                        </div>
                        <div
                          class="external-event bg-danger"
                          data-toggle="modal"
                          data-target="#MaisInfo"
                        >
                          Sleep tight
                        </div> -->
                        <div id="PostWrapper"></div>
                        <div class="checkbox" hidden>
                          <label for="drop-remove">
                            <input type="checkbox" id="drop-remove" />
                            remove after drop
                          </label>
                        </div>
                      </div>
                    </div>
                    <!-- /.card-body -->
                  </div>
                  <!-- /.card -->
                  <div class="card">
                    <div class="card-header">
                      <h3 class="card-title">Criar uma atividade</h3>
                    </div>
                    <div class="card-body">
                      <div
                        class="btn-group"
                        style="width: 100%; margin-bottom: 10px"
                      >
                        <ul class="fc-color-picker" id="color-chooser">
                          <li>
                            <a class="text-primary" href="#"
                              ><i class="fas fa-square"></i
                            ></a>
                          </li>
                          <li>
                            <a class="text-warning" href="#"
                              ><i class="fas fa-square"></i
                            ></a>
                          </li>
                          <li>
                            <a class="text-success" href="#"
                              ><i class="fas fa-square"></i
                            ></a>
                          </li>
                          <li>
                            <a class="text-danger" href="#"
                              ><i class="fas fa-square"></i
                            ></a>
                          </li>
                          <li>
                            <a class="text-muted" href="#"
                              ><i class="fas fa-square"></i
                            ></a>
                          </li>
                        </ul>
                      </div>
                      <!-- /btn-group -->
                      <div class="input-group">
                        <form
                          method="POST"
                          action="http://localhost:8080/DAI_backend/register_activity"
                        >
                          <div class="form-group">
                            <input
                              id="new-event"
                              name="activity_name"
                              type="text"
                              class="form-control"
                              placeholder="Nome da atividade"
                              required
                            />
                            <br />
                            <input
                              id="new-event-cidade"
                              type="text"
                              class="form-control"
                              placeholder="Cidade"
                              name="activity_city"
                              required
                            />
                            <br />
                            <input
                              id="new-event-data"
                              type="date"
                              class="form-control"
                              placeholder="Data"
                              name="schedule"
                              required
                            />
                            <br />
                            <input
                              id="new-event-data2"
                              type="date"
                              class="form-control"
                              placeholder="Data"
                              name="schedule_end"
                              required
                            />
                            <br />
                            <input
                              id="new-event-descricao"
                              type="text"
                              class="form-control"
                              placeholder="Descrição"
                              name="description"
                              required
                            />
                            <br />
                            <input
                              id="institutions"
                              type="text"
                              class="form-control"
                              placeholder="Instituição"
                              name="id_institution"
                            />
                            <br />
                            <input
                              id="partners"
                              type="text"
                              class="form-control"
                              placeholder="Parceiros"
                              name="id_partner"
                            />
                            <br />
                            <div class="custom-file">
                              <div class="input-group">
                                <div class="custom-file">
                                  <input
                                    type="file"
                                    class="custom-file-input"
                                    id="new-event-imagem"
                                    name="document"
                                  />
                                  <label
                                    class="custom-file-label"
                                    for="new-event-imagem"
                                    >Adicionar imagem</label
                                  >
                                </div>
                                <div class="input-group-append">
                                  <span class="input-group-text">Carregar</span>
                                </div>
                              </div>
                            </div>
                            <!-- /input-group -->
                          </div>
                          <button
                            type="submit"
                            class="btn btn-primary"
                            class="btn btn-primary"
                          >
                            Criar
                          </button>
                        </form>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- /.col -->
              <div class="col-md-9">
                <div class="card card-primary">
                  <div class="card-body p-0">
                    <!-- THE CALENDAR -->
                    <div id="calendar"></div>
                  </div>
                  <!-- /.card-body -->
                </div>
                <!-- /.card -->
              </div>
              <!-- /.col -->
            </div>
            <!-- /.row -->
          </div>
          <!-- /.container-fluid -->
        </section>
        <!-- /.content -->
      </div>
      <!-- /.content-wrapper -->

      <div class="modal fade" id="MaisInfo2">
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
            <div class="modal-header">
              <button
                type="button"
                class="close"
                data-dismiss="modal"
                aria-label="Close"
              >
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <form>
                <div class="form-row">
                  <div class="form-group col-md-8">
                    <label for="nomeDaAtividade">Nome da atividade</label>
                    <input
                      type="text"
                      class="form-control"
                      id="nomeDaAtividade"
                      value=""
                    />
                  </div>
                  <div class="form-group col-md-4">
                    <label for="cidadeDaAtividade">Cidade</label>
                    <input
                      type="text"
                      class="form-control"
                      id="cidadeDaAtividade"
                    />
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-md-6">
                    <label for="diDaAtividade">Data de inicio</label>
                    <input
                      type="text"
                      class="form-control"
                      id="diDaAtividade"
                      readonly
                    />
                  </div>
                  <div class="form-group col-md-6">
                    <label for="dfDaAtividade">Data de fim</label>
                    <input
                      type="text"
                      class="form-control"
                      id="dfDaAtividade"
                      readonly
                    />
                  </div>
                </div>
                <div class="form-group">
                  <label for="dDaAtividade">Descrição</label>
                  <textarea
                    class="form-control"
                    id="dDaAtividade"
                    rows="3"
                    style="resize: none"
                  ></textarea>
                </div>
                <div class="form-group">
                  <label>Parceiros</label>
                  <select
                    class="select2bs4"
                    multiple="multiple"
                    style="width: 100%"
                  >
                    <option>Alabama</option>
                    <option>Alaska</option>
                    <option>California</option>
                    <option>Delaware</option>
                    <option>Tennessee</option>
                    <option>Texas</option>
                    <option>Washington</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="exampleInputFile2">Adicionar imagem</label>
                  <div class="input-group">
                    <div class="custom-file">
                      <input
                        type="file"
                        class="custom-file-input"
                        id="exampleInputFile2"
                      />
                      <label
                        class="custom-file-label"
                        for="exampleInputFile2"
                      ></label>
                    </div>
                    <div class="input-group-append">
                      <span class="input-group-text">Carregar</span>
                    </div>
                  </div>
                </div>
              </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-primary">Submeter</button>
            </div>
          </div>
          <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
      </div>
      <!-- /.modal -->

      <footer class="main-footer">
        <strong
          >Copyright &copy;
          <a href="http://prochildcolab.pt/">ProChild</a></strong
        >. Todos os direitos reservados.
      </footer>

      <!-- Control Sidebar -->
      <aside class="control-sidebar control-sidebar-dark">
        <!-- Control sidebar content goes here -->
      </aside>
      <!-- /.control-sidebar -->
    </div>
    <!-- ./wrapper -->

    <!-- jQuery -->
    <script src="../plugins/jquery/jquery.min.js"></script>
    <!-- Bootstrap -->
    <script src="../plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- SweetAlert2 -->
    <script src="/plugins/sweetalert2/sweetalert2.min.js"></script>
    <!-- jQuery UI -->
    <script src="../plugins/jquery-ui/jquery-ui.min.js"></script>
    <!-- overlayScrollbars -->
    <script src="/plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>
    <!-- AdminLTE App -->
    <script src="../dist/js/adminlte.min.js"></script>
    <!-- fullCalendar 2.2.5 -->
    <script src="../plugins/moment/moment.min.js"></script>
    <script src="../plugins/fullcalendar/main.js"></script>
    <!-- AdminLTE for demo purposes -->
    <script src="../dist/js/demo.js"></script>
    <!-- bs-custom-file-input -->
    <script src="/Frontend/Backoffice/Adaptado/plugins/bs-custom-file-input/bs-custom-file-input.min.js"></script>
    <!-- Select2 -->
    <script src="/Frontend/Backoffice/Adaptado/plugins/select2/js/select2.full.min.js"></script>
    <!-- Controller -->
    <script src="/Frontend/Backoffice/Adaptado/controllers/controller_calendarioInstituicao.js"></script>
    <!-- Page specific script -->
    <script>
      $(function () {
        //Initialize Select2 Elements
        $(".select2").select2();

        //Initialize Select2 Elements
        $(".select2bs4").select2({
          theme: "bootstrap4",
        });
        /* initialize the external events
      -----------------------------------------------------------------*/
        function ini_events(ele) {
          ele.each(function () {
            // create an Event Object (https://fullcalendar.io/docs/event-object)
            // it doesn't need to have a start or end
            var eventObject = {
              title: $.trim($(this).text()), // use the element's text as the event title
            };

            // store the Event Object in the DOM element so we can get to it later
            $(this).data("eventObject", eventObject);

            // make the event draggable using jQuery UI
            $(this).draggable({
              zIndex: 1070,
              revert: true, // will cause the event to go back to its
              revertDuration: 0, //  original position after the drag
            });
          });
        }

        ini_events($("#external-events div.external-event"));

        /* initialize the calendar
      -----------------------------------------------------------------*/
        //Date for the calendar events (dummy data)
        var date = new Date();
        var d = date.getDate(),
          m = date.getMonth(),
          y = date.getFullYear();

        var Calendar = FullCalendar.Calendar;
        var Draggable = FullCalendar.Draggable;

        var containerEl = document.getElementById("external-events");
        var checkbox = document.getElementById("drop-remove");
        var calendarEl = document.getElementById("calendar");

        // initialize the external events
        // -----------------------------------------------------------------

        new Draggable(containerEl, {
          itemSelector: ".external-event",
          eventData: function (eventEl) {
            return {
              title: eventEl.innerText,
              backgroundColor: window
                .getComputedStyle(eventEl, null)
                .getPropertyValue("background-color"),
              borderColor: window
                .getComputedStyle(eventEl, null)
                .getPropertyValue("background-color"),
              textColor: window
                .getComputedStyle(eventEl, null)
                .getPropertyValue("color"),
            };
          },
        });

        var calendar = new Calendar(calendarEl, {
          headerToolbar: {
            left: "prev,next today",
            center: "title",
            right: "dayGridMonth,timeGridWeek,timeGridDay",
          },
          themeSystem: "bootstrap",
          //Random default events
          events: [
            // {
            //   title: "All Day Event",
            //   start: new Date(y, m, 1),
            //   backgroundColor: "#f56954", //red
            //   borderColor: "#f56954", //red
            //   allDay: true,
            // },
            // {
            //   title: "Long Event",
            //   start: new Date(y, m, d - 5),
            //   end: new Date(y, m, d - 2),
            //   backgroundColor: "#f39c12", //yellow
            //   borderColor: "#f39c12", //yellow
            // },
            // {
            //   title: "Meeting",
            //   start: new Date(y, m, d, 10, 30),
            //   allDay: false,
            //   backgroundColor: "#0073b7", //Blue
            //   borderColor: "#0073b7", //Blue
            // },
            // {
            //   title: "Lunch",
            //   start: new Date(y, m, d, 12, 0),
            //   end: new Date(y, m, d, 14, 0),
            //   allDay: false,
            //   backgroundColor: "#00c0ef", //Info (aqua)
            //   borderColor: "#00c0ef", //Info (aqua)
            // },
            // {
            //   title: "Birthday Party",
            //   start: new Date(y, m, d + 1, 19, 0),
            //   end: new Date(y, m, d + 1, 22, 30),
            //   allDay: false,
            //   backgroundColor: "#00a65a", //Success (green)
            //   borderColor: "#00a65a", //Success (green)
            // },
            // {
            //   title: "Click for Google",
            //   start: new Date(y, m, 28),
            //   end: new Date(y, m, 29),
            //   url: "https://www.google.com/",
            //   backgroundColor: "#3c8dbc", //Primary (light-blue)
            //   borderColor: "#3c8dbc", //Primary (light-blue)
            // },
          ],
          editable: true,
          locale: "pt",
          droppable: true, // this allows things to be dropped onto the calendar !!!
          drop: function (info) {
            // is the "remove after drop" checkbox checked?
            if (checkbox.checked) {
              // if so, remove the element from the "Draggable Events" list
              info.draggedEl.parentNode.removeChild(info.draggedEl);
            }
          },
        });

        calendar.render();
        // $('#calendar').fullCalendar()

        /* ADDING EVENTS */
        var currColor = "#3c8dbc"; //Red by default
        // Color chooser button
        $("#color-chooser > li > a").click(function (e) {
          e.preventDefault();
          // Save color
          currColor = $(this).css("color");
          // Add color effect to button
          $("#add-new-event").css({
            "background-color": currColor,
            "border-color": currColor,
          });
        });
        $("#add-new-event").click(function (e) {
          e.preventDefault();
          // Get value and make sure it is not null
          var val = $("#new-event").val();
          var val2 = $("#new-event-cidade").val();
          var val3 = $("#new-event-descricao").val();
          if (val.length == 0 && val2.length == 0 && val3.length == 0) {
            return;
          }

          // Create events
          var event = $("<div />");
          event
            .css({
              "background-color": currColor,
              "border-color": currColor,
              color: "#fff",
            })
            .addClass("external-event");

          event.text(val);
          $("#external-events").prepend(event);

          // Add draggable funtionality
          ini_events(event);

          // Remove event from text input
          $("#new-event").val("");
        });
        bsCustomFileInput.init();
      });

      //formulários
      (async () => {
        var strHtml = "";
        var ents = document.getElementById("institutions");
        const response = await fetch(
          "http://localhost:8080/DAI_backend/read_institution"
        );
        const institutions = await response.json();
        for (const institution of institutions) {
          strHtml += `<option name="${institution.id_institution}" value="${institution.id_institution}"> ${institution.institution_name}</option>`;
          console.log("institution:" + institution.institution_name);
        }
        ents.innerHTML = strHtml;
      })();

      //formulários
      (async () => {
        var strHtml = "";
        var ents = document.getElementById("partners");
        const response = await fetch(
          "http://localhost:8080/DAI_backend/read_partner"
        );
        const partners = await response.json();
        for (const partner of partners) {
          strHtml += `<option name="${partner.id_partner}" value="${partner.id_partner}"> ${partner.name_partner}</option>`;
          console.log("partner:" + partner.name_partner);
        }
        ents.innerHTML = strHtml;
      })();
    </script>
  </body>
</html>
